package com.py.sheet.binarysearch.Hard;

public class Q18_SmallestDivisor {

	public static int smallestDivisor(int[] arr, int K) {
		int maxDivisor=arr[0];
		int ans=-1;
		for(int i=1;i<arr.length;i++) {
			maxDivisor = Math.max(maxDivisor,arr[i]);
		}
		int low=1;
		while(low<=maxDivisor) {
			int mid = low+ (maxDivisor - low)/2; // preventing overflow
			if(isLower(arr,mid,K)) {
				ans=mid;
				maxDivisor=mid-1;
			}else {
				low = mid+1;
			}
		}
        return ans;
    }
	
	private static boolean isLower(int[] arr, int mid, int k) {
		int divSum=0;
		for(int ele:arr) {
			divSum+= (int) Math.ceil(ele*1.0/mid);
		}
		return divSum<=k;
	}

	/*
	 * Find smallest divisor in the array
	 * such that the sum of divisions result is 
	 * <= K
	 */
	public static void main(String[] args) {
		int arr[]= {26 ,28, 91 ,87 ,80 ,26 ,82 ,57, 28, 34 ,34 ,5 ,58, 60, 100, 11, 35, 25, 89, 77 ,85 ,87, 38, 4 ,63 ,51 ,1, 1 ,12 ,98 ,18, 22, 85, 88, 46 ,42 ,62 ,82 ,95 ,89 ,86
				,29, 93 ,55 ,48, 44, 16, 64, 48, 91, 89, 8 ,30, 72, 61, 60, 23 ,58, 83 ,40, 5 ,51, 89, 58, 78 ,14, 70, 99, 80, 62, 2 ,62, 23 ,22, 39 ,34, 50, 9
				,87, 27 ,91 ,31 ,42 ,50, 6, 85, 37, 75, 83, 57, 31 ,28, 63 ,90, 15, 29, 8 ,51 ,18 ,48, 100 ,81, 2, 34, 53 ,26, 11, 81, 73 ,28, 21 ,23, 43, 62, 95, 19 
				,48 ,9, 79 ,35, 52, 58, 57 ,90 ,14, 30, 4 ,98 ,69 ,82 ,26 ,4 ,95 ,20 ,23 ,14 ,42 ,100 ,26 ,38 ,94, 28 ,27 ,62 ,42 ,4 ,41 ,35 ,66 ,81 ,62 ,70 ,52 ,66 ,
				86 ,44 ,17 ,80 ,61 ,17 ,3 ,36, 43, 51, 5, 11, 22, 27, 43, 10, 47, 72, 90, 61 ,37, 35, 38, 88, 78, 79, 66, 32, 90, 30, 99, 39, 53, 79, 6 ,4 ,48, 13, 7,
				45 ,60 ,5 ,42 ,45 ,82 ,12 ,31 ,28 ,14 ,55 ,12 ,41 ,45 ,14 ,8 ,51 ,92 ,65 ,29 ,15 ,96 ,45 ,27 ,33 ,2 ,12 ,79 ,57 ,60 ,72 ,33 ,16 ,45 ,14 ,22 ,39 ,
				15, 56, 64, 67, 80, 55, 15, 98, 9, 87, 43, 69, 7, 43, 71, 74, 2 ,97 ,54 ,15 ,94 ,29 ,41 ,52 ,50 ,53, 84, 30, 50, 58, 92, 32, 62, 65, 20, 15, 75, 72, 
				50 ,24 ,48 ,90 ,25 ,29 ,93 ,91 ,44 ,76 ,67 ,45 ,86 ,62 ,96 ,48 ,100 ,24 ,100 ,36 ,50 ,42 ,32 ,49 ,41 ,53 ,58 ,58 ,68 ,99 ,73, 6 ,46 ,36, 7 ,11 ,20 ,19 ,
				100, 55, 4 ,13 ,4 ,1 ,81, 85, 24, 83, 67, 2 ,21 ,81 ,73 ,49 ,30 ,67 ,61, 90, 99, 3 ,24, 19, 30 ,89, 63, 70, 92, 18, 81, 44, 87, 14, 42, 71, 91, 93, 19, 
				9, 35, 16, 87, 69 ,86 ,33 ,50 ,86 ,61 ,20 ,44 ,54 ,78 ,52 ,96 ,89 ,9 ,53 ,1 ,25 ,78 ,95 ,80 ,40 ,27 ,75 ,87 ,51 ,67 ,92 ,98 ,62 ,68 ,62 ,45 ,2 ,57,46,
				97,30,83,52,86,45,45,4,39,86,18,95,28,54,22,74,45,22,3,84,72,56,65,28,37,47,3,1,27,64,100,97,50,33,70,40,54,92,83};//{1,2,5,9};
		int K=31521;//6;
		System.out.printf("The divisor is:: %d",smallestDivisor(arr, K));

	}

}
